"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.generateToken = exports.registerToken = exports.parseToken = void 0;

var _apolloServer = require("apollo-server");

var _jsonwebtoken = _interopRequireDefault(require("jsonwebtoken"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const secret = process.env.SECRET || 'ASea$2gadj#asd0';

const parseToken = token => _jsonwebtoken.default.verify(token, secret);

exports.parseToken = parseToken;

const registerToken = token => {
  try {
    const {
      cookie,
      sessionId
    } = parseToken(token);
    return {
      userToken: token,
      rockCookie: cookie,
      sessionId
    };
  } catch (e) {
    throw new _apolloServer.AuthenticationError('Invalid token');
  }
};

exports.registerToken = registerToken;

const generateToken = params => _jsonwebtoken.default.sign({ ...params
}, secret, {
  expiresIn: '60d'
});

exports.generateToken = generateToken;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90b2tlbi5qcyJdLCJuYW1lcyI6WyJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiU0VDUkVUIiwicGFyc2VUb2tlbiIsInRva2VuIiwiand0IiwidmVyaWZ5IiwicmVnaXN0ZXJUb2tlbiIsImNvb2tpZSIsInNlc3Npb25JZCIsInVzZXJUb2tlbiIsInJvY2tDb29raWUiLCJlIiwiQXV0aGVudGljYXRpb25FcnJvciIsImdlbmVyYXRlVG9rZW4iLCJwYXJhbXMiLCJzaWduIiwiZXhwaXJlc0luIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7Ozs7QUFFQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxNQUFaLElBQXNCLGlCQUFyQzs7QUFFTyxNQUFNQyxVQUFVLEdBQUlDLEtBQUQsSUFBV0Msc0JBQUlDLE1BQUosQ0FBV0YsS0FBWCxFQUFrQkwsTUFBbEIsQ0FBOUI7Ozs7QUFFQSxNQUFNUSxhQUFhLEdBQUlILEtBQUQsSUFBVztBQUN0QyxNQUFJO0FBQ0YsVUFBTTtBQUFFSSxNQUFBQSxNQUFGO0FBQVVDLE1BQUFBO0FBQVYsUUFBd0JOLFVBQVUsQ0FBQ0MsS0FBRCxDQUF4QztBQUVBLFdBQU87QUFDTE0sTUFBQUEsU0FBUyxFQUFFTixLQUROO0FBRUxPLE1BQUFBLFVBQVUsRUFBRUgsTUFGUDtBQUdMQyxNQUFBQTtBQUhLLEtBQVA7QUFLRCxHQVJELENBUUUsT0FBT0csQ0FBUCxFQUFVO0FBQ1YsVUFBTSxJQUFJQyxpQ0FBSixDQUF3QixlQUF4QixDQUFOO0FBQ0Q7QUFDRixDQVpNOzs7O0FBY0EsTUFBTUMsYUFBYSxHQUFJQyxNQUFELElBQzNCVixzQkFBSVcsSUFBSixDQUFTLEVBQUUsR0FBR0Q7QUFBTCxDQUFULEVBQXdCaEIsTUFBeEIsRUFBZ0M7QUFBRWtCLEVBQUFBLFNBQVMsRUFBRTtBQUFiLENBQWhDLENBREsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBdXRoZW50aWNhdGlvbkVycm9yIH0gZnJvbSAnYXBvbGxvLXNlcnZlcic7XG5pbXBvcnQgand0IGZyb20gJ2pzb253ZWJ0b2tlbic7XG5cbmNvbnN0IHNlY3JldCA9IHByb2Nlc3MuZW52LlNFQ1JFVCB8fCAnQVNlYSQyZ2FkaiNhc2QwJztcblxuZXhwb3J0IGNvbnN0IHBhcnNlVG9rZW4gPSAodG9rZW4pID0+IGp3dC52ZXJpZnkodG9rZW4sIHNlY3JldCk7XG5cbmV4cG9ydCBjb25zdCByZWdpc3RlclRva2VuID0gKHRva2VuKSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBjb29raWUsIHNlc3Npb25JZCB9ID0gcGFyc2VUb2tlbih0b2tlbik7XG5cbiAgICByZXR1cm4ge1xuICAgICAgdXNlclRva2VuOiB0b2tlbixcbiAgICAgIHJvY2tDb29raWU6IGNvb2tpZSxcbiAgICAgIHNlc3Npb25JZCxcbiAgICB9O1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEF1dGhlbnRpY2F0aW9uRXJyb3IoJ0ludmFsaWQgdG9rZW4nKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IGdlbmVyYXRlVG9rZW4gPSAocGFyYW1zKSA9PlxuICBqd3Quc2lnbih7IC4uLnBhcmFtcyB9LCBzZWNyZXQsIHsgZXhwaXJlc0luOiAnNjBkJyB9KTtcbiJdfQ==